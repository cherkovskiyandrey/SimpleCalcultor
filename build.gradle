group 'ru.cherkovskiy'
version '1.0-SNAPSHOT'

buildscript {
    repositories {
        mavenCentral()
        jcenter()
    }
    dependencies {
        classpath "io.ratpack:ratpack-gradle:1.4.5"
        classpath 'com.github.jengelman.gradle.plugins:shadow:1.2.3'
        classpath "com.eriwen:gradle-js-plugin:1.12.1"
    }
}

apply plugin: "io.ratpack.ratpack-java"
apply plugin: "com.eriwen.gradle.js"
apply plugin: 'com.github.johnrengelman.shadow'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
    jcenter()
}

mainClassName = "ru.cherkovskiy.CalculatorLoader"
ratpack.baseDir = file('src/main/resources/static')

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.12'
}

combineJs {
    source = fileTree("src/main/resources/scripts")
    dest = file("${sourceSets.main.output.resourcesDir}/scripts/all.js")
}


minifyJs {
    source = combineJs
    dest = file("${sourceSets.main.output.resourcesDir}/scripts/all-min.js")
    closure {
        warningLevel = 'QUIET'
        //compilerOptions.languageIn = "ECMASCRIPT5"
    }
}

processResources.dependsOn minifyJs
